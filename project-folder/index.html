<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Night Countdown</title>
<style>
    body {
        margin: 0;
        height: 100vh;
        background: linear-gradient(135deg, #1e3c72, #2a5298);
        display: flex;
        justify-content: center;
        align-items: center;
        font-family: 'Segoe UI', sans-serif;
        color: white;
        text-align: center;
        overflow: hidden;
    }

    .container {
        background: rgba(0, 0, 0, 0.3);
        padding: 40px;
        border-radius: 20px;
        box-shadow: 0 0 30px rgba(0,0,0,0.5);
        animation: fadeIn 1s ease-in-out;
        position: relative;
        z-index: 1;
    }

    h1 {
        font-size: 3rem;
        margin-bottom: 20px;
        text-shadow: 2px 2px 10px black;
    }

    .timer {
        font-size: 5rem;
        font-weight: bold;
        letter-spacing: 5px;
        text-shadow: 2px 2px 15px #ffed4a;
        animation: glow 1.5s infinite;
    }

    button {
        margin-top: 20px;
        padding: 10px 20px;
        font-size: 1.2rem;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        background: #ffed4a;
        color: #333;
        font-weight: bold;
    }

    @keyframes fadeIn {
        from {opacity: 0;}
        to {opacity: 1;}
    }

    @keyframes glow {
        0%, 100% {
            text-shadow: 0 0 20px #ffed4a, 0 0 30px #ffed4a, 0 0 40px #ffed4a;
        }
        50% {
            text-shadow: 0 0 10px #ffed4a, 0 0 20px #ffed4a, 0 0 30px #ffed4a;
        }
    }
</style>
</head>
<body>

<canvas id="confetti-canvas" style="position:fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; z-index:0;"></canvas>
<div class="container">
    <h1>ðŸŽ® Game Night Starts In ðŸŽ®</h1>
    <div class="timer" id="countdown">01:00:00</div>
    <button id="startBtn">Start Countdown</button>
</div>

<audio id="countdownAudio" src="audio.mp3" preload="auto"></audio>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
<script>
let timeInSeconds = 3600; // 1 hour
const countdownEl = document.getElementById("countdown");
const audio = document.getElementById("countdownAudio");
const startBtn = document.getElementById("startBtn");

// Audio segments: countdown time -> [startTimeInAudio, durationInSeconds]
const audioTriggers = {
    3527: [4, 3],
    3001: [10, 3],
    2401: [20, 3],
    1801: [30, 3],
    1201: [40, 3],
    601:  [50, 3],
    301:  [60, 3],
    61:   [70, 3],
    51:   [80, 3],
    41:   [90, 3],
    31:   [100,3],
    21:   [110,3],
    11:   [120,3],
    10:   [130,3],
    9:    [140,3],
    8:    [150,3],
    7:    [160,3],
    6:    [170,3],
    5:    [180,3],
    4:    [190,3],
    3:    [200,3],
    2:    [210,3],
    1:    [220,3]
};

let triggeredTimes = new Set();
let countdownInterval;

function launchConfetti() {
    const duration = 5 * 1000;
    const end = Date.now() + duration;

    (function frame() {
        confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 } });
        confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 } });
        if (Date.now() < end) requestAnimationFrame(frame);
    })();
}

// Play only the designated audio segment
function playSegment(startTime, duration) {
    audio.currentTime = startTime;
    audio.play().catch(e => console.log("Audio blocked:", e));
    setTimeout(() => audio.pause(), duration * 1000);
}

function updateTimer() {
    let hours = Math.floor(timeInSeconds / 3600);
    let minutes = Math.floor((timeInSeconds % 3600) / 60);
    let seconds = timeInSeconds % 60;

    countdownEl.textContent =
        String(hours).padStart(2,'0') + ":" +
        String(minutes).padStart(2,'0') + ":" +
        String(seconds).padStart(2,'0');

    if (audioTriggers[timeInSeconds] && !triggeredTimes.has(timeInSeconds)) {
        const [start, duration] = audioTriggers[timeInSeconds];
        playSegment(start, duration);
        triggeredTimes.add(timeInSeconds);
    }

    if (timeInSeconds > 0) {
        timeInSeconds--;
    } else if (countdownEl.textContent !== "ðŸŽ‰ Let's Go! ðŸŽ‰") {
        countdownEl.textContent = "ðŸŽ‰ Let's Go! ðŸŽ‰";
        launchConfetti();
        clearInterval(countdownInterval);
    }
}

// Start button to enable audio (required by browsers)
startBtn.addEventListener("click", () => {
    startBtn.style.display = "none";
    updateTimer();
    countdownInterval = setInterval(updateTimer, 1000);
});
</script>

</body>
</html>
